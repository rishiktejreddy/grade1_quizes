<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tick âœ“ the Correct Answer</title>

  <link href="https://fonts.googleapis.com/css2?family=Livvic:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">

  <style>

    :root{
      --bg1:#fde2e4;
      --bg2:#e2f0fb;
      --bg3:#e8f8e8;
    }
    body {
      font-family: "Livvic", sans-serif;
      background:
        radial-gradient(circle at top left, var(--bg1), transparent 55%),
        radial-gradient(circle at bottom right, var(--bg2), transparent 55%),
        radial-gradient(circle at center, var(--bg3), #ffffff 60%);
      height: 100vh;
      width: 100%;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }

    .app { width: 100%; max-width: 1100px; padding: 6px 12px; }
    .slide { display: none; }
    .slide.active { display: block; }

    .q-number {
      text-align: center;
      font-size: 18px;
      color: #2F4F4F;
      margin-bottom: 10px;
      font-weight: 500;
    }

    .question {
      margin: 10px auto;
      max-width: 900px;
      text-align: center;
    }

    .q-text {
      font-size: clamp(20pt, 4vw, 34pt);
      color: #2F4F4F;
      margin-bottom: 18px;
      display: inline-block;
      line-height: 1.2;
      font-weight: 400;
    }

    .blank {
      border-bottom: 3px dashed #2F4F4F;
      min-width: 80px;
      display: inline-block;
    }

    .opts {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .opt-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
      position: relative;
    }

    /* âœ… RECTANGULAR OPTION CARDS (not circular) */
    .opt {
      background: white;
      border-radius: 25px;
      border: 6px solid #fff;
      width: 250px;
      height: 200px;
      cursor: pointer;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
      transition: transform 0.2s;
      overflow: hidden;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .opt:hover { transform: scale(1.05); }

    .opt img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .placeholder {
      font-size: 26px;
      font-weight: 900;
      color: #2F4F4F;
      padding: 10px;
    }

    .label {
      font-size: 24px;
      font-weight: 700;
      color: #2F4F4F;
      font-family: 'Livvic', sans-serif;
      text-align: center;
    }

    .tick { display:none !important; }

    .opt.correct { border-color: #2ed573; background: #dff9fb; pointer-events: none; }
    .opt.wrong { border-color: #dc3545; background: #ffe6e6; animation: shake 0.4s; }
    .opt-container.faded { opacity: 0.35; pointer-events: none; }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-8px); }
      75% { transform: translateX(8px); }
    }


    /* NAV */
    .nav-btn {
      position: fixed;
      top: 50%;
      transform: translateY(-50%);
      background: #4cc9f0;
      border: 4px solid white;
      padding: 15px 30px;
      border-radius: 50px;
      font-size: 24px;
      cursor: pointer;
      color: #2F4F4F;
      z-index: 100;
      font-family: 'Fredoka One', cursive;
      user-select: none;
    }
    #backBtn { left: 20px; background: #f778a1; }
    #bigNext { right: 20px; display: none; }
    #bigNext.show { display: block; }

    /* Smiley overlay */
    .smiley-overlay {
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%) scale(0.5);
      font-size: 180px;
      opacity: 0;
      z-index: 2000;
      transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      pointer-events: none;
      text-shadow: 0 20px 35px rgba(0,0,0,0.15);
    }
    .smiley-overlay.show { opacity: 1; transform: translate(-50%, -50%) scale(1); }

    /* Confetti container */
    .confetti {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1500;
      overflow: hidden;
    }
    .confetti-piece {
      position: absolute;
      width: 10px;
      height: 12px;
      top: -20px;
      animation: fall 1.8s linear forwards;
    }
    @keyframes fall {
      to { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }

    /* Read btn */
    .bird-btn {
      background: #FFD54F;
      border: none;
      width: 65px;
      height: 65px;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 6px 0 #E0B93F;
      margin-left: 15px;
      vertical-align: middle;
    }
    .bird-btn svg { width: 34px; fill: #2C3E50; }

    /* Final modal */
    .final-modal-overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.5);
      display: flex; align-items: center; justify-content: center;
      z-index: 3000; backdrop-filter: blur(5px);
    }
    .final-modal {
      background: #C2F4FF;
      padding: 50px;
      border-radius: 40px;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      width: min(650px, 90%);
    }
  </style>
</head>

<body>
  <div class="app">

    <div id="slides"></div>

    <button id="backBtn" class="nav-btn">â—€ PREV</button>
    <button id="bigNext" class="nav-btn">NEXT â–¶</button>

    <div class="confetti" id="confetti"></div>
    <div id="feedbackSmiley" class="smiley-overlay"></div>
  </div>

  <script>
    const quiz = [
      {
        text: "We breathe through our _____.",
        options: [
          { label: "nose", img: "../uploads/nose.png" },
          { label: "ears", img: "../uploads/ear.png" },
          { label: "eyes", img: "../uploads/eyes.png" }
        ],
        correctIndex: 0
      },
      {
        text: "We hear with our _____.",
        options: [
          { label: "nose", img: "../uploads/nose.png" },
          { label: "skin", img: "../uploads/skin.png" },
          { label: "ears", img: "../uploads/ear.png" }
        ],
        correctIndex: 2
      },
      {
        text: "We must wash our eyes with cool and ____ water.",
        options: [
          { label: "dirty", img: "../uploads/dirty.png" },
          { label: "clean", img: "../uploads/clean.png" },
          { label: "hot", img: "../uploads/hot.png" }
        ],
        correctIndex: 1
      },
      {
        text: "We should take a bath _____.",
        options: [
          { label: "twice in a week", img: "../uploads/twice-week.png" },
          { label: "once in a week", img: "../uploads/once-week.png" },
          { label: "every day", img: "../uploads/everyday.png" }
        ],
        correctIndex: 2
      },
      {
        text: "We should brush our teeth _____.",
        options: [
          { label: "once in a day", img: "../uploads/once-day.png" },
          { label: "twice in a day", img: "../uploads/twice-day.png" },
          { label: "twice in a week", img: "../uploads/twice-week.png" }
        ],
        correctIndex: 1
      }
    ];

    const slidesRoot = document.getElementById("slides");
    const backBtn = document.getElementById("backBtn");
    const bigNext = document.getElementById("bigNext");
    const confettiContainer = document.getElementById("confetti");
    const feedbackSmiley = document.getElementById("feedbackSmiley");

    let current = 0;

    function getCurrentQuestionEl() {
      const slides = Array.from(document.querySelectorAll(".slide"));
      return slides[current].querySelector(".question");
    }

    function isCurrentAnswered() {
      return getCurrentQuestionEl().dataset.answered === "true";
    }

    function speakText(txt) {
      if (!("speechSynthesis" in window)) return;
      window.speechSynthesis.cancel();
      const u = new SpeechSynthesisUtterance(txt.replace(/_+/g, " blank "));
      u.lang = "en-IN";
      u.rate = 0.95;
      window.speechSynthesis.speak(u);
    }

    /* âœ… WebAudio (no mp3) */
    let audioCtx = null;
    function ensureAudio(){
      if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      if(audioCtx.state === "suspended") audioCtx.resume();
      return audioCtx;
    }

    function playSuccessSound(){
      const ctx = ensureAudio();
      const now = ctx.currentTime;

      const notes = [880, 1100, 1320];
      const master = ctx.createGain();
      master.gain.setValueAtTime(0, now);
      master.gain.linearRampToValueAtTime(0.22, now + 0.01);
      master.gain.exponentialRampToValueAtTime(0.0001, now + 0.8);
      master.connect(ctx.destination);

      notes.forEach((freq, i) => {
        const o = ctx.createOscillator();
        o.type = "sine";
        o.frequency.setValueAtTime(freq, now + i * 0.12);
        o.connect(master);
        o.start(now + i * 0.12);
        o.stop(now + i * 0.12 + 0.25);
      });
    }

    function playZzzSound(){
      const ctx = ensureAudio();
      const now = ctx.currentTime;

      const o = ctx.createOscillator();
      const g = ctx.createGain();

      o.type = "sine";
      o.frequency.setValueAtTime(220, now);
      o.frequency.exponentialRampToValueAtTime(140, now + 0.35);

      g.gain.setValueAtTime(0.001, now);
      g.gain.linearRampToValueAtTime(0.16, now + 0.02);
      g.gain.exponentialRampToValueAtTime(0.0001, now + 0.45);

      o.connect(g);
      g.connect(ctx.destination);

      o.start(now);
      o.stop(now + 0.45);
    }

    function triggerConfetti(count = 90) {
      confettiContainer.innerHTML = "";
      const colors = ["#f778a1", "#4cc9f0", "#ffaa00", "#2ed573", "#ff4fd8"];
      for (let i = 0; i < count; i++) {
        const p = document.createElement("div");
        p.className = "confetti-piece";
        p.style.left = Math.random() * 100 + "%";
        p.style.background = colors[Math.floor(Math.random() * colors.length)];
        p.style.animationDuration = (1.2 + Math.random() * 1.1) + "s";
        confettiContainer.appendChild(p);
      }
      setTimeout(() => confettiContainer.innerHTML = "", 2200);
    }

    function showSmiley(emoji) {
      feedbackSmiley.innerText = emoji;
      feedbackSmiley.classList.add("show");
      setTimeout(() => feedbackSmiley.classList.remove("show"), 1200);
    }

    function renderSlides() {
      slidesRoot.innerHTML = "";

      quiz.forEach((q, index) => {
        const slide = document.createElement("div");
        slide.className = "slide" + (index === 0 ? " active" : "");

        slide.innerHTML = `
          <div class="question" data-answered="false">
            <div class="q-number">Question ${index + 1} of ${quiz.length}</div>

            <span class="q-text">
              ${q.text.replace("_____", `<span class="blank">_____</span>`)}
            </span>

            <button class="bird-btn" title="Read question">
              <svg viewBox="0 0 24 24">
                <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/>
              </svg>
            </button>

            <div class="opts">
              ${q.options.map((opt, i) => `
                <div class="opt-container">
                  <div class="opt" data-index="${i}">
                    ${
                      opt.img
                        ? `<img src="${opt.img}" alt="${opt.label}">`
                        : `<div class="placeholder">${opt.label}</div>`
                    }
                  </div>
                  <div class="label">${opt.label}</div>
                </div>
              `).join("")}
            </div>
          </div>
        `;

        slidesRoot.appendChild(slide);

        slide.querySelector(".bird-btn").addEventListener("click", () => speakText(q.text));
        slide.querySelectorAll(".opt").forEach(optEl => {
          optEl.addEventListener("click", () => handleOptionClick(optEl, q, slide, index));
        });
      });
    }

    function handleOptionClick(optEl, q, slide, qIndex) {
      const questionEl = slide.querySelector(".question");
      if (questionEl.dataset.answered === "true") return;

      const chosenIndex = Number(optEl.dataset.index);
      const allContainers = slide.querySelectorAll(".opt-container");

      if (chosenIndex === q.correctIndex) {
        optEl.classList.add("correct");
        questionEl.dataset.answered = "true";

        allContainers.forEach(cont => {
          const contOpt = cont.querySelector(".opt");
          if (contOpt !== optEl) cont.classList.add("faded");
        });

        // âœ… correct: smile + confetti + celebration sound
        showSmiley("ðŸ˜„");
        triggerConfetti(120);
        playSuccessSound();

        bigNext.classList.add("show");
        bigNext.innerText = (current === quiz.length - 1) ? "FINISH" : "NEXT â–¶";
      } else {
        optEl.classList.add("wrong");

        // âœ… wrong: crying + zzz sound
        showSmiley("ðŸ˜¢");
        playZzzSound();

        setTimeout(() => optEl.classList.remove("wrong"), 850);
      }
    }

    function showSlide(index) {
      const slides = Array.from(document.querySelectorAll(".slide"));
      slides.forEach((s, i) => s.classList.toggle("active", i === index));
      current = index;

      backBtn.style.display = (current === 0) ? "none" : "block";

      const answered = slides[current].querySelector(".question").dataset.answered === "true";
      bigNext.classList.toggle("show", answered);
      bigNext.innerText = (current === quiz.length - 1) ? "FINISH" : "NEXT â–¶";
    }

    function showFinalModal() {
      triggerConfetti(220);
      showSmiley("ðŸ¥³");
      playSuccessSound();

      const div = document.createElement("div");
      div.className = "final-modal-overlay";
      div.innerHTML = `
        <div class="final-modal">
          <h1 style="font-family:'Fredoka One', cursive; color:#2c7a4b; font-size:50px; margin:0;">
            ðŸŽ‰ YOU WON! ðŸŽ‰
          </h1>
          <p style="font-size:24px; color:#2F4F4F; margin-top:14px;">
            Great job! You finished all questions âœ…
          </p>
          <button class="nav-btn"
            style="position:static; margin-top:20px; background:#4cc9f0; color:white; border:none;"
            onclick="location.reload()">
            PLAY AGAIN â†º
          </button>
        </div>
      `;
      document.body.appendChild(div);
    }

    bigNext.addEventListener("click", () => {
      if (!isCurrentAnswered()) return;

      if (current < quiz.length - 1) {
        showSlide(current + 1);
      } else {
        showFinalModal();
      }
    });

    backBtn.addEventListener("click", () => {
      if (current > 0) showSlide(current - 1);
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "ArrowRight") {
        if (!isCurrentAnswered()) e.preventDefault();
      }
    });

    // âœ… init
    renderSlides();
    showSlide(0);
  </script>
</body>
</html>
